<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: utils/index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: utils/index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Отрендерить элемент в DOM
 * @function
 * @param {HTMLElement} container - родительский контейнер
 * @param {HTMLElement} element - элемент, который нужно отрисовать
 * @param {string} place - позиция рендеринга
 */
export const render = (container, element, place) => {
  if (container) {
    switch (place) {
      case Positioning.AFTERBEGIN:
        container.prepend(element);
        break;
      case Positioning.BEFOREEND:
        container.append(element);
        break;
      case Positioning.AFTEREND:
        container.after(element);
        break;
    }
  }
};

/**
 * Удалить элемент из DOM
 * @function
 * @param {HTMLElement} element - элемент, который нужно удалить
 */
export const unrender = element => {
  if (element) {
    element.remove();
  }
};

/**
 * Создать элемент из template
 * @param {string} template - разметка
 * @return {HTMLElement} - элемент, который можно отрендерит в DOM
 */
export const createElement = template => {
  const newTemplate = document.createElement(`template`);
  newTemplate.innerHTML = template;
  return newTemplate.content.firstElementChild;
};

/**
 * Разбивка списка фильмов по жанрам
 * @param {Array} list – список фильмов
 * @return {Object} – {genre: array}
 */
export const getMoviesDataByFilters = list => {
  const getMoviesListByFilter = filter => {
    switch (filter) {
      case Filters.ALL:
        return list;
      case Filters.WATCHLIST:
        return list.filter(({ isInWatchList }) => !!isInWatchList);
      case Filters.HISTORY:
        return list.filter(({ isWatched }) => !!isWatched);
      case Filters.FAVORITES:
        return list.filter(({ isFavorite }) => !!isFavorite);
    }
    return list;
  };

  return Object.values(Filters).reduce((acc, filter) => {
    acc[filter] = getMoviesListByFilter(filter);
    return acc;
  }, {});
};

/**
 * форматировить продолжительность фильма
 * @param {Number} duration - продолжительность фильма в минутах
 * @return {String} – продолжительность в формате  `1h 36m`
 */
export const formatDurationFromMinutes = duration => {
  const hours = `${Math.trunc(duration / 60)}`;
  const minutes = `${duration % 60}`;
  return `${hours > 0 ? `${hours}h ` : ``}${minutes}m`;
};

/**
 * получить уникальный id для пользователя
 * @function
 * @return {number} - возыращает уникальный id
 */
export const getUniqueID = () => {
  return (
    Date.now().toString(36) +
    Math.random()
      .toString(36)
      .substr(2, 5)
  );
};

/**
 * получить ранг пользователя (по просмотренным фильмам)
 * @function
 * @param {Array} movies – список фильмов
 * @return {String}
 */
export const getUserRank = movies => {
  const watchedMoviesNumber = movies.filter(({ isWatched }) => !!isWatched)
    .length;
  switch (true) {
    case watchedMoviesNumber > 0 &amp;&amp; watchedMoviesNumber &lt;= 10:
      return `novice`;
    case watchedMoviesNumber > 10 &amp;&amp; watchedMoviesNumber &lt;= 20:
      return `fan`;
    case watchedMoviesNumber > 20:
      return `movie buff`;
    default:
      return null;
  }
};

/**
 * выбрать данные о статусе по имени
 * @function
 * @param {String} name
 * @return {Object}
 */
export const getStatusDataByName = name => {
  return Object.keys(Statuses).reduce((obj, key) => {
    if (Statuses[key].name === name) {
      obj = { ...Statuses[key] };
    }
    return obj;
  }, {});
};

/**
 * вернуть строку без знаков пунктуации
 * @function
 * @param {String} string
 * @return {String}
 */
export const removePunctuation = string => {
  return string.replace(/[^A-Za-z0-9\s]/g, ``).replace(/\s{2,}/g, ` `);
};

/**
 * создает ошибку (ошибка которую получили с сервера)
 * @function
 * @param {Number} status
 * @param {String} message
 */
export function APIerror(status, message) {
  this.name = "APIerror";
  this.status = status;
  this.message = message;
  this.prototype = Object.create(Error.prototype);

  if (Error.captureStackTrace) {
    Error.captureStackTrace(this, this.constructor);
  } else {
    this.stack = new Error().stack;
  }
}

/**
 * получить отформатированное сообщение об ошибке
 * @function
 * @param {Object} error
 * @return {String}
 */
export const getErrorMessage = error => {
  const { message, errors } = error;
  if (!errors) {
    return message || `Oops, something went wrong!`;
  }
  const errorMessagesList = errors
    .map(({ fieldName, errorMessage }) => `${fieldName} ${errorMessage}`)
    .join(`, `);
  return `${message}: ${errorMessagesList}`
    .split(``)
    .map((char, index) => {
      if (index === 0) {
        return char.toUpperCase();
      }
      return char.toLowerCase();
    })
    .join(``);
};

/**
 * создать delay на n милесекунд
 * @function
 * @param {Number} ms
 * @return {Promise}
 */
export const delay = ms => {
  return new Promise(resolve => {
    setTimeout(resolve, ms);
  });
};

// ENUMS_______________________

/**
 * Доступные фильтры по фильмам
 * @readonly
 * @enum {string}
 */
export const Filters = {
  ALL: `All movies`,
  WATCHLIST: `Watchlist`,
  HISTORY: `History`,
  FAVORITES: `Favorites`
};

/**
 * Доступные экраны приложения
 * @readonly
 * @enum {string}
 */
export const Screens = {
  STATISTICS: `Statistics`,
  FILMS: `Films`,
  SEARCH: `Search`
};

/**
 * Доступные значения для статуса фильма
 * @readonly
 * @enum {Object}
 */
export const Statuses = {
  WATCHED: {
    name: `watched`,
    text: `Already watched`,
    prop: `isWatched`
  },
  WATCHLIST: {
    name: `watchlist`,
    text: `Add to watchlist`,
    prop: `isInWatchList`
  },
  FAVORITE: {
    name: `favorite`,
    text: `Add to favorites`,
    prop: `isFavorite`
  }
};

/**
 * Позиция элемента внетри родителя при рендеринге в DOM
 * @readonly
 * @enum {string}
 */
export const Positioning = {
  BEFOREEND: `beforeend`,
  AFTERBEGIN: `afterbegin`,
  AFTEREND: `afterend`
};

// MOCS
export const getFishText = () =>
  [
    `Lorem ipsum dolor sit amet, consectetur adipiscing elit.`,
    `Cras aliquet varius magna, non porta ligula feugiat eget.`,
    `Fusce tristique felis at fermentum pharetra.`,
    `Aliquam id orci ut lectus varius viverra.`,
    `Nullam nunc ex, convallis sed finibus eget, sollicitudin eget ante.`,
    `Phasellus eros mauris, condimentum sed nibh vitae, sodales efficitur ipsum.`,
    `Sed blandit, eros vel aliquam faucibus, purus ex euismod diam, eu luctus nunc ante ut dui.`,
    `Sed sed nisi sed augue convallis suscipit in sed felis.`,
    `Aliquam erat volutpat.`,
    `Nunc fermentum tortor ac porta dapibus.`,
    `In rutrum ac purus sit amet tempus.`
  ]
    .sort(() => Math.random() - Math.random())
    .slice(0, Math.ceil(Math.random() * 3))
    .join(` `);

export const getRandomDate = startDate => {
  const from = new Date(startDate).getTime();
  const to = Date.now();
  return new Date(from + Math.random() * (to - from));
};

export const getRandomArrayItem = array => {
  return array[Math.floor(Math.random() * array.length)];
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="CommentController.html">CommentController</a></li><li><a href="CommentsListController.html">CommentsListController</a></li><li><a href="MovieController.html">MovieController</a></li><li><a href="MoviesBoardController.html">MoviesBoardController</a></li><li><a href="MoviesListController.html">MoviesListController</a></li><li><a href="NavigationController.html">NavigationController</a></li><li><a href="PageController.html">PageController</a></li><li><a href="SearchController.html">SearchController</a></li><li><a href="StatisticsController.html">StatisticsController</a></li></ul><h3>Global</h3><ul><li><a href="global.html#APIerror">APIerror</a></li><li><a href="global.html#createElement">createElement</a></li><li><a href="global.html#delay">delay</a></li><li><a href="global.html#Filters">Filters</a></li><li><a href="global.html#formatDurationFromMinutes">formatDurationFromMinutes</a></li><li><a href="global.html#getErrorMessage">getErrorMessage</a></li><li><a href="global.html#getMoviesDataByFilters">getMoviesDataByFilters</a></li><li><a href="global.html#getStatusDataByName">getStatusDataByName</a></li><li><a href="global.html#getUniqueID">getUniqueID</a></li><li><a href="global.html#getUserRank">getUserRank</a></li><li><a href="global.html#Positioning">Positioning</a></li><li><a href="global.html#removePunctuation">removePunctuation</a></li><li><a href="global.html#render">render</a></li><li><a href="global.html#Screens">Screens</a></li><li><a href="global.html#Statuses">Statuses</a></li><li><a href="global.html#unrender">unrender</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Tue Feb 25 2020 18:50:37 GMT+0300 (Moscow Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
